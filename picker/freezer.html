<!-- ============================================================
AO-05/15 ‚Äî PICKER Shell (egen HTML-sida) | FIL-ID: picker/freezer.html
Projekt: Fryslager (UI-only / localStorage-first)

Syfte:
- Plockare ska ha en egen sida (ingen admin-UI).
- Visar PICKER-rutor via router-menyn (renderas av freezer-picker.js via FreezerViewRegistry).
- Fail-closed: om registry/router/store saknas -> visa minimal fallback och inga actions.

POLICY (L√ÖST):
- UI-only ‚Ä¢ inga nya storage-keys/datamodell
- XSS-safe (ingen innerHTML)
- P0: picker-controller f√•r INTE init f√∂re ESM registry √§r redo -> v√§ntar/pollar (i freezer-picker.js)

P0-FIX:
- Ingen init/hydrate i HTML. FreezerStore init/hydrate sker endast i freezer-picker.js efter registry-ready.

St√§d:
- <link rel="icon" href="data:,"> f√∂r att slippa favicon-404
============================================================ -->
<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Freezer ‚Äì Plockare</title>

  <!-- St√§d: slipp favicon-404 -->
  <link rel="icon" href="data:,">

  <style>
    :root { color-scheme: light; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }

    header { border-bottom:1px solid #e6e6e6; background:#fff; }
    main { background:#f6f7f8; min-height: calc(100vh - 64px); }

    .wrap { max-width: 1100px; margin: 0 auto; padding: 12px 14px; }
    .row { display:flex; gap:12px; align-items:center; flex-wrap:wrap; }

    .brand { font-weight:700; }
    nav a { text-decoration:none; color:inherit; opacity:.8; }
    nav a:hover { opacity:1; }

    .spacer { flex: 1; }

    .pill {
      display:inline-flex; gap:8px; align-items:center;
      padding:6px 10px; border-radius:999px;
      border:1px solid #e6e6e6; background:#fafafa;
      font-size: 13px;
    }
    .pill b { font-weight:600; }
    .muted { opacity:.75; }

    .panel { border:1px solid #e6e6e6; border-radius: 12px; padding: 12px; background:#fff; }

    .tabs { display:flex; gap:8px; flex-wrap:wrap; }
    .tabBtn {
      border:1px solid #e6e6e6; background:#fff;
      border-radius:999px; padding:8px 12px;
      cursor:pointer; font-size: 14px;
    }
    .tabBtn[aria-selected="true"] { font-weight:700; }

    .danger { border-color:#f2b8b5; background:#fff5f5; }
    .ok { border-color:#cfe9cf; background:#f4fff4; }

    .btn { border:1px solid #e6e6e6; background:#fff; border-radius: 10px; padding:8px 10px; cursor:pointer; }
    .btn[disabled] { opacity:.55; cursor:not-allowed; }

    footer { padding: 16px 0; }
    .hr { height:1px; background:#eee; margin:10px 0; }

    .fallbackBox { padding:12px; border-radius:12px; border:1px dashed #ddd; background:#fff; }

    /* a11y */
    :focus-visible { outline: 2px solid #111; outline-offset: 2px; }
  </style>
</head>

<body>
  <header>
    <div class="wrap">
      <div class="row">
        <div class="brand" aria-label="Produktnamn">üßä Freezer</div>

        <nav class="row" aria-label="Picker navigation">
          <a href="../admin/index.html" class="muted">Admin Hem</a>
          <span class="muted" aria-hidden="true">/</span>
          <a href="./freezer.html"><b>Plockare</b></a>
        </nav>

        <div class="spacer" aria-hidden="true"></div>

        <!-- Status -->
        <div id="frzStatusPill" class="pill" role="status" aria-live="polite">
          <span class="muted">Status:</span>
          <b id="frzStatusText">Laddar‚Ä¶</b>
        </div>

        <div class="pill" title="Roll √§r l√•st p√• denna sida">
          <span class="muted">Roll:</span>
          <b>PLOCKARE</b>
        </div>

        <button id="frzResetDemoBtn" class="btn" type="button" title="√Öterst√§ll demo-data (endast om ej read-only)">
          √Öterst√§ll demo
        </button>
      </div>
    </div>
  </header>

  <main>
    <div class="wrap">
      <noscript>
        <section class="panel danger">
          <b>JavaScript kr√§vs</b>
          <div class="muted">Aktivera JavaScript f√∂r att anv√§nda Plockare-sidan.</div>
        </section>
      </noscript>

      <!-- Fail-closed -->
      <section id="frzLockPanel" class="panel danger" hidden>
        <div class="row">
          <div>
            <b>Import stoppad / L√•st l√§ge</b>
            <div class="muted" id="frzLockReason">Orsak: ok√§nd</div>
          </div>
        </div>
      </section>

      <!-- Debug (visas bara vid avvikelse enligt freezer-picker.js) -->
      <section id="frzDebugPanel" class="panel" hidden>
        <div class="row">
          <b>Debug</b>
          <div class="spacer"></div>
          <div class="muted" id="frzDebugText">‚Äî</div>
        </div>
      </section>

      <!-- PICKER ROUTER YTA -->
      <section class="panel">
        <div class="row">
          <div>
            <h1 style="margin:0; font-size:22px;">Plockare</h1>
            <div class="muted" style="margin-top:4px;">
              V√§lj vad du vill g√∂ra i fryslagret.
            </div>
          </div>

          <div class="spacer"></div>

          <div class="pill" title="Visar om sidan √§r read-only">
            <span class="muted">L√§ge:</span>
            <b id="frzModeText">‚Äî</b>
          </div>
        </div>

        <div class="hr" aria-hidden="true"></div>

        <!-- Router-meny -->
        <div id="freezerViewMenu" class="tabs" aria-label="Router-meny">
          <!-- fylls av freezer-picker.js -->
        </div>

        <!-- Router-root -->
        <div id="freezerViewRoot" style="margin-top:10px;">
          <div id="frzPickerFallback" class="fallbackBox muted" role="status" aria-live="polite">
            Laddar vyer‚Ä¶
          </div>
        </div>
      </section>

      <footer class="muted">
        AO-05/15 ‚Ä¢ PICKER shell ‚Ä¢ UI-only ‚Ä¢ localStorage-first ‚Ä¢ fail-closed
      </footer>
    </div>
  </main>

  <!-- ==========================================================
  Script order (KRITISK):
  Core ‚Üí Contract ‚Üí Store ‚Üí Render/Dash ‚Üí ModalShell ‚Üí ESM views/registry ‚Üí picker controller (defer)
  =========================================================== -->

  <!-- Core -->
  <script src="../UI/pages/freezer/02-core.js"></script>
  <script src="../UI/pages/freezer/04-contract.js"></script>

  <!-- Store (M√ÖSTE skapa window.FreezerStore) -->
  <script src="../UI/pages/freezer/03-store.js"></script>

  <!-- Render + dash (valfritt) -->
  <script src="../UI/freezer-render.js"></script>
  <script src="../UI/freezer-dashboard.js"></script>

  <!-- Modal shell (window.FreezerModal) -->
  <script src="../UI/pages/freezer/05-modal-shell.js"></script>

  <!-- ESM views + registry (M√ÖSTE vara type="module") -->
  <script type="module" src="../UI/pages/freezer/00-view-interface.js"></script>
  <script type="module" src="../UI/pages/freezer/01-view-registry.js"></script>

  <!-- OBS:
    Picker-vyerna kan laddas av freezer-picker.js (lazy import med try/catch),
    eller l√§ggas till h√§r som extra <script type="module" src="..."> om ni vill styra exakt per sida.
    Vi gissar inte h√§r f√∂r att undvika 404 om filerna inte finns √§nnu.
  -->

  <!-- Picker controller (P0: defer + v√§ntar/pollar p√• registry innan init/hydrate) -->
  <script defer src="../UI/pages/freezer/picker/freezer-picker.js"></script>

  <!-- ==========================================================
  √ÑNDRINGSLOGG (‚â§8)
  1) Produktionsklar AO-05/15 PICKER shell med fail-closed paneler + router-yta.
  2) Favicon-st√§d: <link rel="icon" href="data:,"> f√∂r att slippa 404.
  3) Script-ordning l√•st: core/contract/store/modal ‚Üí ESM registry ‚Üí controller (defer).
  4) Ingen init/hydrate i HTML (controller ansvarar).
  =========================================================== -->

  <!-- ==========================================================
  TESTNOTERINGAR (klicktest)
  - √ñppna picker/freezer.html ‚Üí Console:
    - Inga 404 p√• scripts.
    - window.FreezerStore finns efter 03-store.js.
    - window.FreezerViewRegistry finns efter ESM-laddning.
  - N√§r freezer-picker.js finns:
    - Menyknappar syns i #freezerViewMenu.
    - Klick byter vy i #freezerViewRoot utan krasch.
  =========================================================== -->
</body>
</html>
